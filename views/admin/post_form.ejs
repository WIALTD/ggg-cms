<div class="container">
    <div class="admin-header">
        <h1><%= action === 'create' ? 'Create New Post' : 'Edit Post' %></h1>
        <a href="/admin/posts" class="btn btn-secondary">‚Üê Back to Posts</a>
    </div>

    <div class="post-form-container">
        <% if (typeof error !== 'undefined' && error) { %>
            <div class="error-message">
                <%= error %>
            </div>
        <% } %>

        <form method="POST" action="<%= action === 'create' ? '/admin/posts' : '/admin/posts/' + post.id %>" class="post-form">
            <div class="form-row">
                <div class="form-group">
                    <label for="title">Title *</label>
                    <input 
                        type="text" 
                        id="title" 
                        name="title" 
                        required 
                        value="<%= post ? post.title : '' %>"
                        placeholder="Enter post title"
                    >
                </div>
                
                <div class="form-group">
                    <label for="slug">Slug *</label>
                    <input 
                        type="text" 
                        id="slug" 
                        name="slug" 
                        required 
                        value="<%= post ? post.slug : '' %>"
                        placeholder="url-friendly-slug"
                    >
                    <small class="form-help">Used in the URL: /destinations/your-slug</small>
                </div>
            </div>

            <div class="form-row">
                <div class="form-group">
                    <label for="status">Status</label>
                    <select id="status" name="status">
                        <option value="draft" <%= (post && post.status === 'draft') || !post ? 'selected' : '' %>>Draft</option>
                        <option value="published" <%= post && post.status === 'published' ? 'selected' : '' %>>Published</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="featured_image">Featured Image URL</label>
                    <input 
                        type="url" 
                        id="featured_image" 
                        name="featured_image" 
                        value="<%= post ? post.featured_image || '' : '' %>"
                        placeholder="https://example.com/image.jpg"
                    >
                    <small class="form-help">
                        Optional. Used for social media sharing. <a href="/admin/upload" target="_blank">Upload an image</a>
                    </small>
                </div>
            </div>

            <div class="form-group">
                <label for="body_md">Content (Markdown) *</label>
                <textarea 
                    id="body_md" 
                    name="body_md" 
                    required 
                    rows="20"
                    placeholder="Write your post content in Markdown..."
                ><%= post ? post.body_md : '' %></textarea>
                <small class="form-help">
                    Use Markdown syntax. <a href="https://www.markdownguide.org/cheat-sheet/" target="_blank">Markdown Cheat Sheet</a>
                </small>
            </div>

            <div class="form-actions">
                <button type="submit" class="btn btn-primary">
                    <%= action === 'create' ? 'Create Post' : 'Update Post' %>
                </button>
                <a href="/admin/posts" class="btn btn-secondary">Cancel</a>
            </div>
        </form>
    </div>

    <% if (action === 'edit' && post) { %>
        <div class="post-preview">
            <h3>Preview</h3>
            <div class="preview-content">
                <h1><%= post.title %></h1>
                <div class="post-meta">
                    <span class="status-badge status-<%= post.status %>"><%= post.status %></span>
                    <span class="muted">Last updated: <%= new Date(post.updated_at).toLocaleString() %></span>
                </div>
                <div class="preview-body">
                    <%- post.body_html %>
                </div>
            </div>
        </div>
    <% } %>
</div>
